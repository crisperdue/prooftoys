<!-- In current form this emits script tag per source file -->
  {{ $si := resources.Get "/js/site.js" }}
  {{ $ut := resources.Get "/js/util.js" }}
  {{ $tc := resources.Get "/js/jquery.tableofcontents.js" }}
  {{ $pre := resources.Get "/js/prelim.js" }}
  {{ $ex := resources.Get "/js/expr.js" }}
  {{ $xu := resources.Get "/js/xutil.js" }}
  {{ $en := resources.Get "/js/engine.js" }}
  {{ $un := resources.Get "/js/unify.js" }}
  {{ $lo := resources.Get "/js/logic.js" }}
  {{ $nu := resources.Get "/js/numbers.js" }}
  {{ $nn := resources.Get "/js/natnums.js" }}
  {{ $st := resources.Get "/js/step-editor.js" }}
  {{ $re := resources.Get "/js/rendering.js" }}
  {{ $so := resources.Get "/js/solution-status.js" }}
  {{ $pd := resources.Get "/js/proof-data.js" }}
  {{ $all := slice $si $tc $ut $pre $ex $xu $en $un $lo $nu $nn $st $re $so $pd }}
  {{ $allJS := resources.Concat "/js/all.js" $all }}
  {{ if eq hugo.Environment "development" }}
    {{ range $all }}
      <!-- Experiment with "defer", though it does not function
           as advertised; see for example partials/jquery.html. -->
      <script src="{{ .RelPermalink }}"></script>
    {{ end }}
  {{ else }}   
    <script src="{{ $allJS.RelPermalink }}"></script>
  {{ end }}

  {{/* This specifies that a runtime import from
       "js/<etc>" translates to a request for /pt/js/<etc>.
        TODO: Translate path to just /js/<etc>, here and in
          the uses below.
    */}}
<script type="importmap">
  {
    "imports": {
      "js/": "/pt/js/"
    }
  }
</script>

{{ $db := resources.Get "/pt/js/db.js" }}
<script type=module src="{{ $db.RelPermalink }}"></script>

{{/* This stimulates Hugo to include dexie.js in the site.
     TODO: Use Hugo to avoid having to check it in (in js/).
     It could be accessed as dexie/dist/dexie.mjs, and Concat'ed
     to /js/dexie.js.
  */}}
{{ $dx := resources.Get "/pt/js/dexie.js" }}
<!-- {{ $dx.RelPermalink }}. Comment not emitted by Hugo. -->
